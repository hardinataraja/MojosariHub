<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Direktori Bisnis - Mojosari Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-slate-900">
    <header class="bg-blue-700 text-white p-4 shadow-md sticky top-0 z-50">
        <div class="container mx-auto flex items-center gap-4">
            <a href="index.html" class="hover:opacity-80">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                </svg>
            </a>
            <h1 class="text-xl font-bold uppercase tracking-tight">Eksplor Mojosari</h1>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8 max-w-6xl mb-24">
        <div class="mb-8">
            <h2 class="text-2xl font-black text-slate-800 uppercase italic">Direktori Bisnis & Layanan</h2>
            <p class="text-gray-500">Temukan tempat terbaik untuk segala kebutuhan Anda di wilayah Mojosari.</p>
        </div>

        <div id="full-directory" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
            <div class="col-span-full py-20 text-center text-gray-400">Sedang memuat data...</div>
        </div>
    </div>

    <footer class="bg-white border-t p-6 text-center text-xs text-gray-400">
        MOJOSARI HUB - DIREKTORI BISNIS LOKAL
    </footer>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycby0uZJ3Frb0n006Tt9KSDEFAbLhhwigLT9WhfbjUmO4Wd01A4vD3H6D6CAjA2Md89CA/exec";

        async function loadAllDirectory() {
            try {
                const res = await fetch(SCRIPT_URL + "?type=directory");
                let dir = await res.json();

                // SORTING: PREMIUM DULU (RATING > 5), KEMUDIAN RATING TINGGI KE RENDAH
                dir.sort((a, b) => parseFloat(b.rating) - parseFloat(a.rating));

                let html = '';
                dir.forEach(item => {
                    const r = parseFloat(item.rating);
                    const isPremium = r > 5;
                    const badgeText = isPremium ? "⭐️ PREMIUM PARTNER" : `⭐ ${r}`;
                    const cardStyle = isPremium ? "ring-2 ring-yellow-400 bg-yellow-50 shadow-xl" : "bg-white shadow-md border-gray-100";

                    html += `
                    <div class="rounded-3xl overflow-hidden transition transform hover:-translate-y-1 ${cardStyle} flex flex-col h-full">
                        <div class="relative h-52">
                            <img src="${item.foto}" class="w-full h-full object-cover">
                            <div class="absolute top-3 left-3 bg-white/90 backdrop-blur px-3 py-1.5 rounded-full text-[10px] font-black text-blue-700 shadow-sm uppercase italic">
                                ${badgeText}
                            </div>
                        </div>
                        <div class="p-6 flex flex-col flex-grow">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-blue-600 text-[10px] font-bold uppercase tracking-widest">${item.jenis}</span>
                            </div>
                            <h3 class="font-extrabold text-xl text-slate-800 mb-2 leading-tight">${item.nama}</h3>
                            <p class="text-gray-500 text-sm italic mb-6 leading-relaxed">"${item.desc}"</p>
                            
                            <div class="mt-auto space-y-2">
                                <a href="${item.maps}" target="_blank" class="w-full flex items-center justify-center gap-2 ${isPremium ? 'bg-yellow-500' : 'bg-slate-800'} text-white py-3 rounded-2xl text-xs font-bold hover:opacity-90 transition">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                                    </svg>
                                    Buka Google Maps
                                </a>
                            </div>
                        </div>
                    </div>`;
                });
                document.getElementById('full-directory').innerHTML = html;
            } catch (e) {
                document.getElementById('full-directory').innerHTML = "<p class='text-center col-span-full'>Gagal memuat data. Periksa koneksi internet.</p>";
            }
        }
        window.onload = loadAllDirectory;
    </script>
</body>
</html>
